/*
 * This source file was generated by the Gradle 'init' task
 */
package _PostgresConnect;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class Library {
	 public static void main(String[] args) {
	        String host = "localhost";   // Rancher NodePort exposed to localhost
	        String port = "30007";       // kubectl get svc -> NodePort
	        String database = "mydb";    // from postgres.yaml
	        String user = "dbuser";      // from postgres.yaml
	        String password = "dbpass";  // from postgres.yaml

	        // Force valid timezone (avoid Asia/Calcutta issue)
	        String url = String.format(
	        	    "jdbc:postgresql://%s:%s/%s?options=-c%%20TimeZone=Asia/Kolkata",
	        	    host, port, database
	        	);

	        try {
	            Class.forName("org.postgresql.Driver");
	            Connection conn = DriverManager.getConnection(url, user, password);
	            System.out.println("✅ Connected to PostgreSQL successfully!");

	            String sql = "SELECT version()";
	            PreparedStatement stmt = conn.prepareStatement(sql);
	            ResultSet rs = stmt.executeQuery();

	            if (rs.next()) {
	                System.out.println("PostgreSQL version: " + rs.getString(1));
	            }

	            rs.close();
	            stmt.close();
	            conn.close();
	        } catch (Exception e) {
	            System.err.println("❌ Connection failed: " + e.getMessage());
	            e.printStackTrace();
	        }
	    }
}
